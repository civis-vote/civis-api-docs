{
  "openapi" : "3.0.0",
  "info" : {
    "description" : "This is Civs' REST API documentation\n",
    "version" : "1.0.1",
    "title" : "Civis",
    "termsOfService" : "https://www.civis.vote/terms",
    "contact" : {
      "email" : "mkv@commutatus.com"
    },
    "license" : {
      "name" : "MIT",
      "url" : "https://github.com/civis-vote/civis-api/blob/develop/LICENSE"
    }
  },
  "servers" : [ {
    "description" : "SwaggerHub API Auto Mocking",
    "url" : "https://virtserver.swaggerhub.com/Civis/Civis/1.0.1"
  }, {
    "description" : "SwaggerHub API Auto Mocking",
    "url" : "https://virtserver.swaggerhub.com/mikevic/Civis/1.0.1"
  } ],
  "tags" : [ {
    "name" : "consultation",
    "description" : "A document that an organisation requires public or private feedback on"
  }, {
    "name" : "response",
    "description" : "A response is feedback to a consultation"
  }, {
    "name" : "ministry",
    "description" : "A government department that can launch multiple consultations."
  } ],
  "paths" : {
    "/consultations/_search" : {
      "post" : {
        "tags" : [ "consultation" ],
        "summary" : "List consultations",
        "operationId" : "listConsultations",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/ConsultationSearch"
        },
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "array",
                  "items" : {
                    "$ref" : "#/components/schemas/Consultation"
                  }
                }
              }
            }
          },
          "default" : {
            "description" : "Request failed",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "description" : "Get a list of consultations"
      }
    },
    "/consultations/_create" : {
      "post" : {
        "tags" : [ "consultation" ],
        "summary" : "Create consultation",
        "operationId" : "createConsultation",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/Consultation"
        },
        "responses" : {
          "200" : {
            "description" : "created",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "items" : {
                    "$ref" : "#/components/schemas/Consultation"
                  }
                }
              }
            }
          },
          "default" : {
            "description" : "Request failed",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/consultations/_update" : {
      "post" : {
        "tags" : [ "consultation" ],
        "summary" : "Update consultation",
        "operationId" : "updateConsultation",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/ConsultationUpdate"
        },
        "responses" : {
          "200" : {
            "description" : "updates have been accepted",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "items" : {
                    "$ref" : "#/components/schemas/Consultation"
                  }
                }
              }
            }
          },
          "default" : {
            "description" : "Request failed",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/consultations/_delete" : {
      "post" : {
        "tags" : [ "consultation" ],
        "summary" : "Delete consultation",
        "operationId" : "deleteConsultation",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/Id"
        },
        "responses" : {
          "200" : {
            "description" : "consultation queued for deletion"
          },
          "default" : {
            "description" : "Request failed",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/consultations/_publish" : {
      "post" : {
        "tags" : [ "consultation" ],
        "summary" : "Publish consultation",
        "operationId" : "publishConsultation",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/Id"
        },
        "responses" : {
          "200" : {
            "description" : "consultation published",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "items" : {
                    "$ref" : "#/components/schemas/Consultation"
                  }
                }
              }
            }
          },
          "default" : {
            "description" : "Request failed",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/consultations/_reject" : {
      "post" : {
        "tags" : [ "consultation" ],
        "summary" : "Reject consultation",
        "operationId" : "rejectConsultation",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/Id"
        },
        "responses" : {
          "200" : {
            "description" : "consultation rejected",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "object",
                  "items" : {
                    "$ref" : "#/components/schemas/Consultation"
                  }
                }
              }
            }
          },
          "default" : {
            "description" : "Request failed",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/responses" : {
      "get" : {
        "tags" : [ "response" ],
        "summary" : "List responses",
        "operationId" : "listResponses",
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "array",
                  "items" : {
                    "$ref" : "#/components/schemas/Response"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/ministries" : {
      "get" : {
        "tags" : [ "ministry" ],
        "summary" : "List ministries",
        "operationId" : "listMinistries",
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "content" : {
              "application/json" : {
                "schema" : {
                  "type" : "array",
                  "items" : {
                    "$ref" : "#/components/schemas/Ministry"
                  }
                }
              }
            }
          }
        }
      },
      "post" : {
        "tags" : [ "ministry" ],
        "summary" : "Create a ministry",
        "operationId" : "createMinistry",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/Ministry"
        },
        "responses" : {
          "201" : {
            "description" : "created",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Ministry"
                }
              }
            }
          }
        }
      }
    },
    "/ministries/{MinistryId}" : {
      "get" : {
        "tags" : [ "ministry" ],
        "summary" : "Get a ministry",
        "operationId" : "getMinistry",
        "parameters" : [ {
          "in" : "path",
          "name" : "MinistryId",
          "schema" : {
            "type" : "integer"
          },
          "required" : true
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Ministry"
                }
              }
            }
          }
        }
      },
      "patch" : {
        "tags" : [ "ministry" ],
        "summary" : "Update a ministry",
        "operationId" : "updateMinistry",
        "parameters" : [ {
          "in" : "path",
          "name" : "MinistryId",
          "schema" : {
            "type" : "integer"
          },
          "required" : true
        } ],
        "requestBody" : {
          "$ref" : "#/components/requestBodies/Ministry"
        },
        "responses" : {
          "202" : {
            "description" : "updates have been accepted",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Ministry"
                }
              }
            }
          },
          "401" : {
            "description" : "user does not have permission to update ministry"
          }
        }
      },
      "delete" : {
        "tags" : [ "ministry" ],
        "summary" : "Delete a ministry",
        "operationId" : "deleteMinistry",
        "parameters" : [ {
          "in" : "path",
          "name" : "MinistryId",
          "schema" : {
            "type" : "integer"
          },
          "required" : true
        } ],
        "responses" : {
          "202" : {
            "description" : "consultation queued for deletion"
          },
          "401" : {
            "description" : "user does not have permission to delete ministry"
          }
        }
      }
    },
    "/ministries/{MinistryId}/publish" : {
      "post" : {
        "tags" : [ "ministry" ],
        "summary" : "Publish a ministry",
        "operationId" : "publishMinistry",
        "parameters" : [ {
          "in" : "path",
          "name" : "MinistryId",
          "schema" : {
            "type" : "integer"
          },
          "required" : true
        } ],
        "responses" : {
          "200" : {
            "description" : "ministry published",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Ministry"
                }
              }
            }
          },
          "401" : {
            "description" : "user does not have permission to publish a ministry"
          }
        }
      }
    },
    "/ministry/{MinistryId}/reject" : {
      "post" : {
        "tags" : [ "ministry" ],
        "summary" : "Reject a ministry",
        "operationId" : "rejectMinistry",
        "parameters" : [ {
          "in" : "path",
          "name" : "MinistryId",
          "schema" : {
            "type" : "integer"
          },
          "required" : true
        } ],
        "responses" : {
          "200" : {
            "description" : "ministry rejected",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Ministry"
                }
              }
            }
          },
          "401" : {
            "description" : "user does not have permission to reject a ministry"
          }
        }
      }
    }
  },
  "components" : {
    "schemas" : {
      "Consultation" : {
        "type" : "object",
        "properties" : {
          "id" : {
            "type" : "integer",
            "format" : "int64"
          },
          "title" : {
            "type" : "string",
            "description" : "Title of the consultation"
          },
          "created_at" : {
            "type" : "string",
            "format" : "date-time"
          },
          "created_by" : {
            "$ref" : "#/components/schemas/UserPublicProfile"
          },
          "published_at" : {
            "type" : "string",
            "format" : "date-time"
          },
          "rejected_at" : {
            "type" : "string",
            "format" : "date-time"
          },
          "response_deadline" : {
            "type" : "string",
            "format" : "date-time"
          },
          "ministry" : {
            "$ref" : "#/components/schemas/Ministry"
          },
          "is_featured" : {
            "type" : "boolean"
          },
          "status" : {
            "$ref" : "#/components/schemas/ConsultationStatus"
          },
          "summary" : {
            "type" : "string"
          }
        }
      },
      "Response" : {
        "type" : "object",
        "properties" : {
          "id" : {
            "type" : "integer",
            "format" : "int64"
          },
          "consultation_id" : {
            "type" : "integer",
            "format" : "int64",
            "description" : "ID of the consultation associated with this response"
          },
          "user_id" : {
            "type" : "integer",
            "format" : "int64",
            "description" : "ID of the user associated with this response"
          },
          "published_at" : {
            "type" : "string",
            "format" : "date-time"
          },
          "rejected_at" : {
            "type" : "string",
            "format" : "date-time"
          },
          "response_deadline" : {
            "type" : "string",
            "format" : "date-time"
          },
          "summary" : {
            "type" : "string"
          }
        }
      },
      "Ministry" : {
        "type" : "object",
        "properties" : {
          "id" : {
            "type" : "integer",
            "format" : "int64"
          },
          "name" : {
            "type" : "string",
            "description" : "Name of the ministry"
          },
          "created_at" : {
            "type" : "string",
            "format" : "date-time"
          },
          "level" : {
            "$ref" : "#/components/schemas/MinistryLevel"
          },
          "summary" : {
            "type" : "string"
          },
          "status" : {
            "$ref" : "#/components/schemas/MinistryStatus"
          }
        }
      },
      "UserPublicProfile" : {
        "type" : "object",
        "properties" : {
          "id" : {
            "type" : "integer",
            "format" : "int64"
          },
          "first_name" : {
            "type" : "string"
          },
          "last_name" : {
            "type" : "string"
          },
          "profile_picture" : {
            "type" : "string",
            "format" : "uri"
          }
        }
      },
      "MinistryStatus" : {
        "type" : "string",
        "enum" : [ "approved", "rejected", "in_reivew" ]
      },
      "MinistryLevel" : {
        "type" : "string",
        "enum" : [ "local", "state", "national" ]
      },
      "ConsultationStatus" : {
        "type" : "string",
        "enum" : [ "draft", "active", "rejected", "closed" ]
      },
      "Error" : {
        "description" : "In case of any failure during processing of the requests server is required to return the error object. It is recommended taht error codes are namespaced error codes taht can provide contexual information about the error just by examining the code, e.g. origin.badlocation.\nIn case debug is permitted for a certain role, api client has indicated the need to get the debug information during the call and server is configured to honor the debug infromation request - it is recommended that highly detailed ifnormation about the problem (along with complete stack trace) is provided to the api client.",
        "required" : [ "code", "message" ],
        "type" : "object",
        "readOnly" : true,
        "properties" : {
          "code" : {
            "type" : "string"
          },
          "message" : {
            "type" : "string"
          },
          "debugDetail" : {
            "type" : "string"
          }
        }
      }
    },
    "requestBodies" : {
      "Id" : {
        "description" : "Record ID for the intended operation",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "items" : {
                "type" : "integer"
              }
            }
          }
        }
      },
      "Consultation" : {
        "description" : "Consultation create object",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "properties" : {
                "title" : {
                  "type" : "string"
                },
                "summary" : {
                  "type" : "string"
                }
              }
            }
          }
        }
      },
      "ConsultationUpdate" : {
        "description" : "Consultation update object",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "properties" : {
                "id" : {
                  "type" : "integer"
                },
                "title" : {
                  "type" : "string"
                },
                "summary" : {
                  "type" : "string"
                }
              }
            }
          }
        }
      },
      "ConsultationSearch" : {
        "description" : "Consultation search object",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "properties" : {
                "filters" : {
                  "type" : "object",
                  "properties" : {
                    "status" : {
                      "type" : "array",
                      "items" : {
                        "$ref" : "#/components/schemas/ConsultationStatus"
                      }
                    },
                    "id" : {
                      "type" : "array",
                      "items" : {
                        "type" : "integer"
                      }
                    },
                    "ministry_id" : {
                      "type" : "array",
                      "items" : {
                        "type" : "integer"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "Ministry" : {
        "description" : "Ministry input object",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "properties" : {
                "name" : {
                  "type" : "string"
                },
                "summary" : {
                  "type" : "string"
                }
              }
            }
          }
        }
      }
    }
  }
}